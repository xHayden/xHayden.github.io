<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Nunito+Sans:ital,opsz,wght@0,6..12,200;0,6..12,300;0,6..12,400;1,6..12,200;1,6..12,300&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="/blog/assets/css/main.css">
        <link rel="stylesheet" href="/blog/assets/css/tailwind.css">
        <link rel="stylesheet" href="/blog/assets/css/themes/prism-material-dark.css"/>
        <meta name="description" content="
            
                How to set yourself up for Minecraft automation by getting your computer to read the Minecraft font with Python and PyTesseract.
            
        "/>
        <title>Minecraft OCR With PyTesseract</title>
    </head>
    <body>
        <nav><a href="/blog/">Blog</a><a href="/blog/about/">About</a><a href="/blog/contact/">Contact</a></nav>
        <main>
            <div class="border-b-2 mb-8 pb-2">
    <h1 class="text-amber-400 text-5xl pb-2">Minecraft OCR With PyTesseract</h1>
    <div class="flex justify-between flex-col gap-2">
        <p class="text-xl font-extralight">How to set yourself up for Minecraft automation by getting your computer to read the Minecraft font with Python and PyTesseract.</p>
        <div>
            <p class="text-base">By Hayden Carpenter</p>
            <p class="text-sm">Jul 19, 2020</p>
        </div>
    </div>
</div>
<h2>What is PyTesseract and OCR?</h2>
<p>PyTesseract is an OCR (Optical Character Recognition) tool for Python. Tesseract is available for other languages too, but Python is what I'll be using to do OCR.</p>
<p>OCR lets a program read text on a screen and translate that text into strings.</p>
<h2>Getting Started</h2>
<p>To get started with Tesseract, we'll need to install the executable.
You can find that <a href="https://tesseract-ocr.github.io/tessdoc/4.0-with-LSTM.html#400-alpha-for-windows">here</a>.</p>
<p>We don't just need the executable though. We're going to need some additional modules to get PyTesseract up and running (including PyTesseract).</p>
<pre class="language-sh"><code class="language-sh">pip <span class="token function">install</span> pytesseract</code></pre>
<p>For this tutorial, I'm going to try to parse the coordinates in a Minecraft world. Let's try to do that with Tesseract.
First, lets import Image from Pillow, and pytesseract.</p>
<pre class="language-py"><code class="language-py"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image <span class="token keyword">as</span> im
<span class="token keyword">import</span> pytesseract</code></pre>
<p>To get PyTesseract to work, we're going to have to direct it to the place we installed tesseract to. For me, thats C:\Program Files\Tesseract-OCR.</p>
<pre class="language-py"><code class="language-py"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image <span class="token keyword">as</span> im
<span class="token keyword">import</span> pytesseract
<span class="token keyword">import</span> cv2

pytesseract<span class="token punctuation">.</span>pytesseract<span class="token punctuation">.</span>tesseract_cmd <span class="token operator">=</span> <span class="token string">r'C:\Program Files\Tesseract-OCR\tesseract.exe'</span></code></pre>
<p>Let's take that screenshot.</p>
<p><img src="/blog/assets/images/minecraft-ocr-with-pytesseract/screenshot.png" alt="Minecraft Coordinates">
Lets open this with Pillow's Image and try to use Tesseract to parse it.</p>
<pre class="language-py"><code class="language-py"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image <span class="token keyword">as</span> im
<span class="token keyword">import</span> pytesseract
<span class="token keyword">import</span> cv2

pytesseract<span class="token punctuation">.</span>pytesseract<span class="token punctuation">.</span>tesseract_cmd <span class="token operator">=</span> <span class="token string">r'C:\Program Files\Tesseract-OCR\tesseract.exe'</span>

image <span class="token operator">=</span> im<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'screenshot.png'</span><span class="token punctuation">)</span>
text <span class="token operator">=</span> pytesseract<span class="token punctuation">.</span>image_to_string<span class="token punctuation">(</span>image<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span></code></pre>
<p>Hmm, so it seems we didn't get any text back. This means Tesseract wasn't able to find anything. This makes sense.
Tesseract doesn't support the Minecraft font, and it's so unusual that it makes sense that it couldn't pick up any words.</p>
<h2>Custom Fonts</h2>
<p>To train Tesseract for a new font, I used jTessBoxEditor and serak-tesseract-trainer (Although jTessBoxEditor proved much more helpful).
This process is painful, and I wouldn't recommend it. So to save you time, and pain, here is the .traineddata.</p>
<p><a href="https://github.com/xHayden/Minecraft-OCR">mc.traineddata</a></p>
<p>Go to &quot;C:\Program Files\Tesseract-OCR\tessdata&quot; and place this file there.</p>
<p>To use this trainddata instead of the default, we'll add an argument in our pytesseract.image_to_string call.</p>
<pre class="language-py"><code class="language-py"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image <span class="token keyword">as</span> im
<span class="token keyword">import</span> pytesseract
<span class="token keyword">import</span> cv2

pytesseract<span class="token punctuation">.</span>pytesseract<span class="token punctuation">.</span>tesseract_cmd <span class="token operator">=</span> <span class="token string">r'C:\Program Files\Tesseract-OCR\tesseract.exe'</span>

image <span class="token operator">=</span> im<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'screenshot.png'</span><span class="token punctuation">)</span>
text <span class="token operator">=</span> pytesseract<span class="token punctuation">.</span>image_to_string<span class="token punctuation">(</span>image<span class="token punctuation">,</span> lang<span class="token operator">=</span><span class="token string">'mc'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span></code></pre>
<p>However, running this, we still get no response.
It seems like the text cannot be clearly distinguished from the background.</p>
<p>We'll apply a filter to get rid of that. Lets use opencv for this.</p>
<h2>Isolating the Text</h2>
<p>To install opencv, let's use pip again.</p>
<pre class="language-py"><code class="language-py">pip install opencv<span class="token operator">-</span>python</code></pre>
<p>We import OpenCV as cv2.
We also need to import numpy in order to properly make a mask of the text we're trying to isolate.</p>
<p>We first convert the image to hsv. Then we make numpy arrays to store the image data.
We use numpy arrays of colors to isolate what we need with a mask. To make it easier, you can just trial and error the values.
We then make a mask with cv2.inRange() and use cv2.bitwise_and to remove the colors not included in the coordinate text.</p>
<p>Finally, we convert the colors to greyscale and use cv2.threshold to convert all colors to either white or black.</p>
<p>Now the coordinate text is perfectly clear, and we should be able to read it with Tesseract.</p>
<pre class="language-py"><code class="language-py"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image <span class="token keyword">as</span> im
<span class="token keyword">import</span> pytesseract
<span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

pytesseract<span class="token punctuation">.</span>pytesseract<span class="token punctuation">.</span>tesseract_cmd <span class="token operator">=</span> <span class="token string">r'C:\Program Files\Tesseract-OCR\tesseract.exe'</span>
image <span class="token operator">=</span> im<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'screenshot.png'</span><span class="token punctuation">)</span>

image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_RGB2HSV<span class="token punctuation">)</span>
hsv_image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_RGB2HSV<span class="token punctuation">)</span>

color_lower <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
color_upper <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

mask <span class="token operator">=</span> cv2<span class="token punctuation">.</span>inRange<span class="token punctuation">(</span>hsv_image<span class="token punctuation">,</span> color_lower<span class="token punctuation">,</span> color_upper<span class="token punctuation">)</span>
result <span class="token operator">=</span> cv2<span class="token punctuation">.</span>bitwise_and<span class="token punctuation">(</span>image<span class="token punctuation">,</span> image<span class="token punctuation">,</span> mask<span class="token operator">=</span>mask<span class="token punctuation">)</span>
image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_RGB2GRAY<span class="token punctuation">)</span>

image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>THRESH_BINARY <span class="token operator">|</span> cv2<span class="token punctuation">.</span>THRESH_OTSU<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

text <span class="token operator">=</span> pytesseract<span class="token punctuation">.</span>image_to_string<span class="token punctuation">(</span>image<span class="token punctuation">,</span> lang<span class="token operator">=</span><span class="token string">'mc'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span></code></pre>
<p><img src="/blog/assets/images/minecraft-ocr-with-pytesseract/readable.jpg" alt="readable"></p>
<p><img src="/blog/assets/images/minecraft-ocr-with-pytesseract/working_output_not_cropped.png" alt="output not cropped"></p>
<p>Yes! We got a response. It isn't perfect, but the text is readable. The algorithm seems to get confused with some characters,
particularly 'e' and 'a' and ',' vs '.'.</p>
<p>Let's use this text to get the coordinates.
First though, let's crop out the useless information.</p>
<h2>Cropping</h2>
<p>To do this we're going to use numpy slicing.</p>
<p>Let's add this code to the end of our file.</p>
<pre class="language-py"><code class="language-py">y <span class="token operator">=</span> <span class="token number">180</span>
x <span class="token operator">=</span> <span class="token number">0</span>
h <span class="token operator">=</span> <span class="token number">20</span>
w <span class="token operator">=</span> <span class="token number">500</span>

crop_img <span class="token operator">=</span> image<span class="token punctuation">[</span>y<span class="token punctuation">:</span>y<span class="token operator">+</span>h<span class="token punctuation">,</span> x<span class="token punctuation">:</span>x<span class="token operator">+</span>w<span class="token punctuation">]</span>
cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"cropped"</span><span class="token punctuation">,</span> crop_img<span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></code></pre>
<p><img src="/blog/assets/images/minecraft-ocr-with-pytesseract/cropped.png" alt="cropped image"></p>
<p>Now we've cropped in on our coordinates. Of course the location depends on the resolution of your image. Configure it as you wish.</p>
<p>Let's make Tesseract use this image instead.</p>
<pre class="language-py"><code class="language-py"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image <span class="token keyword">as</span> im
<span class="token keyword">import</span> pytesseract
<span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

pytesseract<span class="token punctuation">.</span>pytesseract<span class="token punctuation">.</span>tesseract_cmd <span class="token operator">=</span> <span class="token string">r'C:\Program Files\Tesseract-OCR\tesseract.exe'</span>
image <span class="token operator">=</span> im<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'screenshot.png'</span><span class="token punctuation">)</span>

image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_RGB2HSV<span class="token punctuation">)</span>
hsv_image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_RGB2HSV<span class="token punctuation">)</span>

color_lower <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
color_upper <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

mask <span class="token operator">=</span> cv2<span class="token punctuation">.</span>inRange<span class="token punctuation">(</span>hsv_image<span class="token punctuation">,</span> color_lower<span class="token punctuation">,</span> color_upper<span class="token punctuation">)</span>

result <span class="token operator">=</span> cv2<span class="token punctuation">.</span>bitwise_and<span class="token punctuation">(</span>image<span class="token punctuation">,</span> image<span class="token punctuation">,</span> mask<span class="token operator">=</span>mask<span class="token punctuation">)</span>
image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_RGB2GRAY<span class="token punctuation">)</span>
image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span>
    cv2<span class="token punctuation">.</span>THRESH_BINARY <span class="token operator">|</span> cv2<span class="token punctuation">.</span>THRESH_OTSU<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

y <span class="token operator">=</span> <span class="token number">180</span>
x <span class="token operator">=</span> <span class="token number">0</span>
h <span class="token operator">=</span> <span class="token number">20</span>
w <span class="token operator">=</span> <span class="token number">500</span>

crop_img <span class="token operator">=</span> image<span class="token punctuation">[</span>y<span class="token punctuation">:</span>y<span class="token operator">+</span>h<span class="token punctuation">,</span> x<span class="token punctuation">:</span>x<span class="token operator">+</span>w<span class="token punctuation">]</span>

text <span class="token operator">=</span> pytesseract<span class="token punctuation">.</span>image_to_string<span class="token punctuation">(</span>crop_img<span class="token punctuation">,</span> lang<span class="token operator">=</span><span class="token string">'mc'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span></code></pre>
<p>It's not perfect, but it works. Let's parse this into an array.</p>
<pre class="language-py"><code class="language-py"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image <span class="token keyword">as</span> im
<span class="token keyword">import</span> pytesseract
<span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

pytesseract<span class="token punctuation">.</span>pytesseract<span class="token punctuation">.</span>tesseract_cmd <span class="token operator">=</span> <span class="token string">r'C:\Program Files\Tesseract-OCR\tesseract.exe'</span>
image <span class="token operator">=</span> im<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'screenshot.png'</span><span class="token punctuation">)</span>

image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_RGB2HSV<span class="token punctuation">)</span>
hsv_image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_RGB2HSV<span class="token punctuation">)</span>

color_lower <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
color_upper <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

mask <span class="token operator">=</span> cv2<span class="token punctuation">.</span>inRange<span class="token punctuation">(</span>hsv_image<span class="token punctuation">,</span> color_lower<span class="token punctuation">,</span> color_upper<span class="token punctuation">)</span>

result <span class="token operator">=</span> cv2<span class="token punctuation">.</span>bitwise_and<span class="token punctuation">(</span>image<span class="token punctuation">,</span> image<span class="token punctuation">,</span> mask<span class="token operator">=</span>mask<span class="token punctuation">)</span>
image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_RGB2GRAY<span class="token punctuation">)</span>
image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span>
    cv2<span class="token punctuation">.</span>THRESH_BINARY <span class="token operator">|</span> cv2<span class="token punctuation">.</span>THRESH_OTSU<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

y <span class="token operator">=</span> <span class="token number">180</span>
x <span class="token operator">=</span> <span class="token number">0</span>
h <span class="token operator">=</span> <span class="token number">20</span>
w <span class="token operator">=</span> <span class="token number">500</span>

crop_img <span class="token operator">=</span> image<span class="token punctuation">[</span>y<span class="token punctuation">:</span>y<span class="token operator">+</span>h<span class="token punctuation">,</span> x<span class="token punctuation">:</span>x<span class="token operator">+</span>w<span class="token punctuation">]</span>

text <span class="token operator">=</span> pytesseract<span class="token punctuation">.</span>image_to_string<span class="token punctuation">(</span>crop_img<span class="token punctuation">,</span> lang<span class="token operator">=</span><span class="token string">'mc'</span><span class="token punctuation">)</span>

textArr <span class="token operator">=</span> text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
coordsArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> string <span class="token keyword">in</span> textArr<span class="token punctuation">:</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">any</span><span class="token punctuation">(</span>char<span class="token punctuation">.</span>isdigit<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> char <span class="token keyword">in</span> string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">','</span> <span class="token keyword">in</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span>
            string <span class="token operator">=</span> string<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span> <span class="token string">'.'</span><span class="token punctuation">)</span>
        coordsArr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>string<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>coordsArr<span class="token punctuation">)</span></code></pre>
<p><img src="/blog/assets/images/minecraft-ocr-with-pytesseract/coords_array.png" alt="coords array"></p>
<p>There we go! We've successfully parsed the coordinates from a screenshot with PyTesseract.</p>
<h2>Conclusion</h2>
<p>PyTesseract is a very powerful tool. Sometimes it needs configuration, but it can allow you to automate a lot of tasks that would be painful for a human to do manually, and the additional setup can definitely be worth it.</p>




<br>

    Next: <a href="/blog/first-post2/">First Post</a>

<br>
        </main>
    </body>
</html>